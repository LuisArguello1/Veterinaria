{% extends 'generic/detail_mixin.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block detail_content %}
<!-- Encabezado del perfil -->
<div class="bg-gradient-to-r from-primary-600 to-secondary-600 -m-6 mb-6 px-6 py-8 text-white rounded-t-lg">
    <div class="flex flex-col md:flex-row items-center">
        <!-- Imagen del perfil -->
        <div class="md:mr-8 mb-4 md:mb-0">
            <div class="w-32 h-32 rounded-full overflow-hidden border-4 border-white shadow-lg bg-white">
                <img src="{{ user_profile.get_image }}" alt="{{ user_profile.get_full_name }}" class="w-full h-full object-cover">
            </div>
        </div>
        
        <!-- Información básica -->
        <div class="text-center md:text-left">
            <h1 class="text-3xl font-bold">{{ user_profile.get_full_name }}</h1>
            <p class="text-primary-100 mt-1">@{{ user_profile.username }}</p>
            <div class="mt-2 inline-flex items-center bg-accent-500/30 px-3 py-1 rounded-full text-sm">
                <i class="fas fa-user-tag mr-2"></i>
                {% if user_profile.is_admin %}
                    Administrador
                {% elif user_profile.is_vet %}
                    Veterinario
                {% else %}
                    Dueño de mascota
                {% endif %}
            </div>
        </div>
        
        <!-- Botones de acción -->
        <div class="ml-auto mt-4 md:mt-0 flex space-x-3">
            <a href="{% url 'auth:profile_edit' %}" class="inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-secondary-600 rounded-md hover:bg-secondary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-secondary-500 transition-all duration-200">
                <i class="fas fa-user-edit mr-2"></i>
                Editar Perfil
            </a>
            <a href="{% url 'auth:profile_password' %}" class="inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-dark-600/40 hover:bg-dark-600/60 border border-white/30 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-white/20 transition-all duration-200">
                <i class="fas fa-key mr-2"></i>
                Cambiar Contraseña
            </a>
        </div>
    </div>
</div>

<!-- Detalles del perfil -->
<div class="bg-white p-6 rounded-lg shadow-sm">
    <h2 class="text-2xl font-bold mb-6 text-dark-800 border-b border-neutral-200 pb-3">Información Personal</h2>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- Columna 1: Datos personales -->
        <div>
            <div class="mb-4">
                <h3 class="text-sm uppercase font-semibold text-neutral-500 tracking-wider mb-1">Nombre completo</h3>
                <p class="text-dark-700 flex items-center">
                    <i class="fas fa-user text-primary-500 mr-2"></i>
                    {{ user_profile.get_full_name }}
                </p>
            </div>
            
            <div class="mb-4">
                <h3 class="text-sm uppercase font-semibold text-neutral-500 tracking-wider mb-1">Correo electrónico</h3>
                <p class="text-dark-700 flex items-center">
                    <i class="fas fa-envelope text-primary-500 mr-2"></i>
                    {{ user_profile.email }}
                </p>
            </div>
            
            <div class="mb-4">
                <h3 class="text-sm uppercase font-semibold text-neutral-500 tracking-wider mb-1">Cédula</h3>
                <p class="text-dark-700 flex items-center">
                    <i class="fas fa-id-card text-primary-500 mr-2"></i>
                    {{ user_profile.dni|default:"No especificado" }}
                </p>
            </div>
        </div>
        
        <!-- Columna 2: Contacto -->
        <div>
            <div class="mb-4">
                <h3 class="text-sm uppercase font-semibold text-neutral-500 tracking-wider mb-1">Teléfono</h3>
                <p class="text-dark-700 flex items-center">
                    <i class="fas fa-phone text-accent-500 mr-2"></i>
                    {{ user_profile.phone|default:"No especificado" }}
                </p>
            </div>
            
            <div class="mb-4">
                <h3 class="text-sm uppercase font-semibold text-neutral-500 tracking-wider mb-1">Dirección</h3>
                <p class="text-dark-700 flex items-center">
                    <i class="fas fa-home text-accent-500 mr-2"></i>
                    {{ user_profile.direction|default:"No especificado" }}
                </p>
            </div>
            
            {% if user_profile.is_vet %}
            <div class="mb-4">
                <h3 class="text-sm uppercase font-semibold text-neutral-500 tracking-wider mb-1">Especialización</h3>
                <p class="text-dark-700 flex items-center">
                    <i class="fas fa-stethoscope text-accent-500 mr-2"></i>
                    {{ user_profile.specialization|default:"No especificado" }}
                </p>
            </div>
            
            <div class="mb-4">
                <h3 class="text-sm uppercase font-semibold text-neutral-500 tracking-wider mb-1">Número de licencia</h3>
                <p class="text-dark-700 flex items-center">
                    <i class="fas fa-certificate text-accent-500 mr-2"></i>
                    {{ user_profile.license_number|default:"No especificado" }}
                </p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Sección de Biometría Facial -->
<div class="bg-white p-6 rounded-lg shadow-sm mt-6">
    <h2 class="text-2xl font-bold mb-4 text-dark-800 border-b border-neutral-200 pb-3 flex items-center">
        <i class="fas fa-user-shield text-primary-600 mr-3"></i>
        Seguridad y Biometría
    </h2>
    
    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200">
        <div class="flex items-start gap-4">
            <div class="flex-shrink-0">
                <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center">
                    <i class="fas fa-user-lock text-white text-2xl"></i>
                </div>
            </div>
            
            <div class="flex-1">
                <h3 class="text-xl font-bold text-gray-800 mb-2">Reconocimiento Facial</h3>
                <p class="text-gray-600 mb-4">
                    Configura tu biometría facial para iniciar sesión de forma rápida y segura sin necesidad de contraseña.
                </p>
                
                {% if has_biometry %}
                    <!-- Usuario con biometría registrada -->
                    <div class="bg-white p-4 rounded-lg shadow-sm mb-4">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center gap-2">
                                {% if biometry_active %}
                                    <span class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></span>
                                    <span class="font-semibold text-green-700">Biometría Activa</span>
                                {% else %}
                                    <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                                    <span class="font-semibold text-yellow-700">Biometría Desactivada</span>
                                {% endif %}
                            </div>
                            <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full">
                                <i class="fas fa-check-circle mr-1"></i>Configurada
                            </span>
                        </div>
                        
                        <!-- Estadísticas -->
                        <div class="grid grid-cols-2 gap-3 mb-3 text-sm">
                            <div class="bg-gray-50 p-2 rounded">
                                <span class="text-gray-600">Logins exitosos:</span>
                                <span class="font-bold text-gray-800 ml-1">{{ biometry_stats.successful_logins }}</span>
                            </div>
                            <div class="bg-gray-50 p-2 rounded">
                                <span class="text-gray-600">Intentos fallidos:</span>
                                <span class="font-bold text-gray-800 ml-1">{{ biometry_stats.failed_attempts }}</span>
                            </div>
                        </div>
                        
                        <div class="text-xs text-gray-500">
                            <p><i class="fas fa-calendar mr-1"></i> Registrada: {{ biometry_stats.registered_at|date:"d/m/Y H:i" }}</p>
                            {% if biometry_stats.last_login %}
                                <p class="mt-1"><i class="fas fa-clock mr-1"></i> Último uso: {{ biometry_stats.last_login|date:"d/m/Y H:i" }}</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <a href="{% url 'auth:facial_biometry_register' %}" 
                       class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                        <i class="fas fa-cog mr-2"></i>
                        Administrar Biometría
                    </a>
                {% else %}
                    <!-- Usuario sin biometría -->
                    <div class="bg-white p-4 rounded-lg shadow-sm mb-4">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="w-3 h-3 bg-gray-400 rounded-full"></span>
                            <span class="font-semibold text-gray-700">Sin Biometría Configurada</span>
                        </div>
                        <p class="text-sm text-gray-600">
                            No has registrado tu biometría facial. Configúrala para disfrutar de un acceso más rápido y seguro.
                        </p>
                    </div>
                    
                    <a href="{% url 'auth:facial_biometry_register' %}" 
                       class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                        <i class="fas fa-user-plus mr-2"></i>
                        Registrar Biometría Facial
                    </a>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="mt-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
        <div class="flex">
            <div class="flex-shrink-0">
                <i class="fas fa-exclamation-triangle text-yellow-400"></i>
            </div>
            <div class="ml-3">
                <h3 class="text-sm font-medium text-yellow-800">Nota de Seguridad</h3>
                <div class="mt-2 text-sm text-yellow-700">
                    <p>Tu información biométrica se almacena de forma segura y encriptada. Nunca compartimos esta información con terceros.</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
