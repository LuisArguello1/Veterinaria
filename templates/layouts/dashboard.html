{% extends "layouts/base.html" %}
{% load static %}

{% block title %} Dashboard - PetFace ID {% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}

<!-- Dashboard Content -->
<div class="space-y-6 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">

    <!-- Cabecera profesional y minimalista del dashboard -->
    <div class="bg-white mb-6 shadow-sm border border-gray-200 rounded-lg overflow-hidden">
        <div class="flex flex-col sm:flex-row items-center p-4 sm:p-0">
            <div class="mr-0 sm:mr-6 bg-black p-2 mb-4 sm:mb-0 self-center sm:self-start">
                <img src="{% static 'img/logo_secundario2.png' %}" alt="Logo Secundario Veterinaria" class="h-16 sm:h-20 w-auto" oncontextmenu="return false;">
            </div>
            <div class="text-center sm:text-left py-2 sm:py-4 flex-grow">
                <h1 class="text-gray-800 text-xl sm:text-2xl font-semibold mb-1">
                    Dashboard - ¡Bienvenido, {{ user.first_name|default:user.username }}!
                </h1>
                <p class="text-gray-600 text-sm sm:text-base">
                    {% if role == 'OWNER' %}
                        <i class="fas fa-heart text-red-500 mr-1"></i> Panel de Propietario - Gestión integral de tus mascotas
                    {% elif role == 'VET' %}
                        <i class="fas fa-stethoscope text-blue-500 mr-1"></i> Panel de Veterinario - Gestión profesional de pacientes
                    {% elif role == 'ADMIN' %}
                        <i class="fas fa-user-cog text-purple-500 mr-1"></i> Panel de Administrador - Control total del sistema
                    {% endif %}
                </p>
            </div>
            <div class="text-center sm:text-right py-2 sm:py-4 flex-shrink-0">
                <div class="flex items-center justify-center sm:justify-end space-x-3">
                    {% if user.image %}
                        <img class="h-12 w-12 rounded-full object-cover border-2 border-gray-300" src="{{ user.image.url }}" alt="Avatar de {{ user.get_full_name }}">
                    {% else %}
                        <div class="h-12 w-12 rounded-full border-2 border-gray-300 bg-gray-100 flex items-center justify-center">
                            <i class="fas fa-user text-gray-500"></i>
                        </div>
                    {% endif %}
                    <div class="text-right">
                        <p class="text-sm text-gray-600">
                            <i class="far fa-calendar-alt mr-1"></i>
                            {{ "now"|date:"d/m/Y" }}
                        </p>
                        <p class="text-xs text-gray-500">
                            <i class="far fa-clock mr-1"></i>
                            {{ "now"|date:"H:i" }}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Métricas Principales -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
        
        {% if role == 'OWNER' %}
            <!-- Métricas para propietarios -->
            <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-16 h-16 bg-blue-50 rounded-bl-3xl -mr-6 -mt-6 z-0"></div>
                <div class="relative z-10 flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 font-medium uppercase tracking-wide">Mis Mascotas</p>
                        <p class="text-2xl font-bold text-blue-600 mt-2">{{ mis_mascotas|default:0 }}</p>
                    </div>
                    <div class="bg-blue-100 p-3 rounded-lg shadow-sm">
                        <i class="fas fa-dog text-blue-600 text-lg"></i>
                    </div>
                </div>
                {% if mis_mascotas > 0 %}
                <div class="mt-3 pt-3 text-xs text-gray-500 border-t border-gray-100">
                    <div class="flex items-center">
                        <div class="w-full h-1.5 bg-gray-100 rounded-full overflow-hidden">
                            <div class="progress-bar-fill bg-blue-500 h-full rounded-full" style="width: {% widthratio mis_mascotas_entrenadas mis_mascotas 100 %}%"></div>
                        </div>
                        <span class="ml-2 min-w-[45px] text-right">{{ mis_mascotas_entrenadas }}/{{ mis_mascotas }}</span>
                    </div>
                </div>
                {% endif %}
            </div>

            <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-16 h-16 bg-green-50 rounded-bl-3xl -mr-6 -mt-6 z-0"></div>
                <div class="relative z-10 flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 font-medium uppercase tracking-wide">Imágenes</p>
                        <p class="text-2xl font-bold text-green-600 mt-2">{{ total_imagenes|default:0 }}</p>
                    </div>
                    <div class="bg-green-100 p-3 rounded-lg shadow-sm">
                        <i class="fas fa-camera text-green-600 text-lg"></i>
                    </div>
                </div>
                <div class="mt-3 pt-3 text-xs text-gray-500 border-t border-gray-100">
                    <span><i class="fas fa-info-circle mr-1"></i> Imágenes de tus mascotas</span>
                </div>
            </div>

            <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-16 h-16 bg-purple-50 rounded-bl-3xl -mr-6 -mt-6 z-0"></div>
                <div class="relative z-10 flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 font-medium uppercase tracking-wide">Progreso</p>
                        <p class="text-2xl font-bold text-purple-600 mt-2">{{ progreso_entrenamiento|default:0 }}%</p>
                    </div>
                    <div class="bg-purple-100 p-3 rounded-lg shadow-sm">
                        <i class="fas fa-chart-line text-purple-600 text-lg"></i>
                    </div>
                </div>
                <div class="mt-3 pt-3 text-xs text-gray-500 border-t border-gray-100">
                    <div class="w-full h-1.5 bg-gray-100 rounded-full overflow-hidden">
                        <div class="progress-bar-fill bg-purple-500 h-full rounded-full" style="width: {{ progreso_entrenamiento|default:0 }}%"></div>
                    </div>
                </div>
            </div>

            <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-16 h-16 {% if mis_mascotas_perdidas > 0 %}bg-red-50{% else %}bg-green-50{% endif %} rounded-bl-3xl -mr-6 -mt-6 z-0"></div>
                <div class="relative z-10 flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 font-medium uppercase tracking-wide">Estado</p>
                        {% if mis_mascotas_perdidas > 0 %}
                            <p class="text-2xl font-bold text-red-600 mt-2">{{ mis_mascotas_perdidas }} Perdida{{ mis_mascotas_perdidas|pluralize }}</p>
                        {% else %}
                            <p class="text-2xl font-bold text-green-600 mt-2">Seguras</p>
                        {% endif %}
                    </div>
                    <div class="{% if mis_mascotas_perdidas > 0 %}bg-red-100{% else %}bg-green-100{% endif %} p-3 rounded-lg shadow-sm">
                        {% if mis_mascotas_perdidas > 0 %}
                            <i class="fas fa-exclamation-triangle text-red-600 text-lg"></i>
                        {% else %}
                            <i class="fas fa-shield-alt text-green-600 text-lg"></i>
                        {% endif %}
                    </div>
                </div>
                <div class="mt-3 pt-3 text-xs text-gray-500 border-t border-gray-100">
                    {% if mis_mascotas_perdidas > 0 %}
                    <span class="text-red-500"><i class="fas fa-exclamation-circle mr-1"></i> Necesitan atención</span>
                    {% else %}
                    <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i> Todas tus mascotas están seguras</span>
                    {% endif %}
                </div>
            </div>

        {% elif role == 'VET' or role == 'ADMIN' %}
            <!-- Métricas para veterinarios y administradores -->
            <div class="stat-card bg-white p-5 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-16 h-16 bg-blue-50 rounded-bl-3xl -mr-6 -mt-6 z-0"></div>
                <div class="relative z-10 flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 font-medium uppercase tracking-wide">Total Mascotas</p>
                        <p class="text-2xl font-bold text-blue-600 mt-2">{{ total_mascotas|default:0 }}</p>
                    </div>
                    <div class="bg-blue-100 p-3 rounded-lg shadow-sm">
                        <i class="fas fa-dog text-blue-600 text-lg"></i>
                    </div>
                </div>
                <div class="mt-3 pt-3 text-xs text-gray-500 border-t border-gray-100">
                    <span><i class="fas fa-plus-circle mr-1"></i> {{ mascotas_nuevas_semana|default:0 }} esta semana</span>
                </div>
            </div>

            <div class="stat-card bg-white p-5 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-16 h-16 bg-green-50 rounded-bl-3xl -mr-6 -mt-6 z-0"></div>
                <div class="relative z-10 flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 font-medium uppercase tracking-wide">Usuarios</p>
                        <p class="text-2xl font-bold text-green-600 mt-2">{{ total_usuarios|default:0 }}</p>
                    </div>
                    <div class="bg-green-100 p-3 rounded-lg shadow-sm">
                        <i class="fas fa-users text-green-600 text-lg"></i>
                    </div>
                </div>
                <div class="mt-3 pt-3 text-xs text-gray-500 border-t border-gray-100">
                    <span><i class="fas fa-info-circle mr-1"></i> Registrados en la plataforma</span>
                </div>
            </div>

            <div class="stat-card bg-white p-5 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-16 h-16 bg-purple-50 rounded-bl-3xl -mr-6 -mt-6 z-0"></div>
                <div class="relative z-10 flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 font-medium uppercase tracking-wide">Reconocimientos</p>
                        <p class="text-2xl font-bold text-purple-600 mt-2">{{ reconocimientos_hoy|default:0 }}</p>
                    </div>
                    <div class="bg-purple-100 p-3 rounded-lg shadow-sm">
                        <i class="fas fa-eye text-purple-600 text-lg"></i>
                    </div>
                </div>
                <div class="mt-3 pt-3 text-xs text-gray-500 border-t border-gray-100">
                    <span><i class="fas fa-calendar-day mr-1"></i> Hoy</span>
                </div>
            </div>

            <div class="stat-card bg-white p-5 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-16 h-16 bg-indigo-50 rounded-bl-3xl -mr-6 -mt-6 z-0"></div>
                <div class="relative z-10 flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 font-medium uppercase tracking-wide">Entrenadas</p>
                        <p class="text-2xl font-bold text-indigo-600 mt-2">{{ mascotas_entrenadas|default:0 }}</p>
                    </div>
                    <div class="bg-indigo-100 p-3 rounded-lg shadow-sm">
                        <i class="fas fa-fingerprint text-indigo-600 text-lg"></i>
                    </div>
                </div>
                <div class="mt-3 pt-3 text-xs text-gray-500 border-t border-gray-100">
                    <span><i class="fas fa-check-circle mr-1"></i> Con biometría completa</span>
                </div>
            </div>
        {% endif %}
    </div>

    <!-- Información Personalizada del Usuario -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-8">
        
        {% if role == 'OWNER' %}
            <!-- Para Propietarios -->
            {% if ultima_mascota %}
            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300">
                <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                    <span class="bg-blue-100 p-2 rounded-md mr-3"><i class="fas fa-dog text-blue-600"></i></span>
                    <span>Última Mascota</span>
                </h3>
                <div class="flex items-center space-x-4">
                    <div class="flex-shrink-0">
                        {% if ultima_mascota.foto_perfil %}
                            <img class="h-12 w-12 rounded-full object-cover" src="{{ ultima_mascota.foto_perfil.url }}" alt="{{ ultima_mascota.nombre }}">
                        {% else %}
                            <div class="h-12 w-12 rounded-full bg-gray-300 flex items-center justify-center">
                                <i class="fas fa-dog text-gray-600"></i>
                            </div>
                        {% endif %}
                    </div>
                    <div class="flex-1">
                        <h4 class="font-medium text-gray-900">{{ ultima_mascota.nombre }}</h4>
                        <p class="text-sm text-gray-500">{{ ultima_mascota.raza|default:"Sin raza" }}</p>
                        <p class="text-xs text-gray-400">{{ ultima_mascota.created_at|date:"d/m/Y" }}</p>
                    </div>
                    {% if ultima_mascota.biometria_entrenada %}
                        <i class="fas fa-check-circle text-green-500"></i>
                    {% else %}
                        <i class="fas fa-clock text-yellow-500"></i>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <!-- Actividad reciente -->
            {% if reconocimientos_recientes %}
            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300">
                <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                    <span class="bg-green-100 p-2 rounded-md mr-3"><i class="fas fa-history text-green-600"></i></span>
                    <span>Actividad Reciente</span>
                </h3>
                <div class="space-y-3">
                    {% for reconocimiento in reconocimientos_recientes %}
                    <div class="flex items-center justify-between text-sm">
                        <div>
                            <p class="font-medium">{{ reconocimiento.mascota_predicha.nombre }}</p>
                            <p class="text-gray-500">{{ reconocimiento.fecha|date:"d/m H:i" }}</p>
                        </div>
                        {% if reconocimiento.exito %}
                            <span class="text-green-600 text-xs">✓ {{ reconocimiento.confianza|floatformat:0 }}%</span>
                        {% else %}
                            <span class="text-red-600 text-xs">✗ {{ reconocimiento.confianza|floatformat:0 }}%</span>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

        {% elif role == 'VET' or role == 'ADMIN' %}
            <!-- Para Veterinarios y Administradores -->
            {% if modelo_activo %}
            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300">
                <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                    <span class="bg-purple-100 p-2 rounded-md mr-3"><i class="fas fa-brain text-purple-600"></i></span>
                    <span>Modelo IA Activo</span>
                </h3>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Versión:</span>
                        <span class="font-medium">{{ modelo_activo.version }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Mascotas:</span>
                        <span class="font-medium">{{ modelo_activo.num_clases }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Actualizado:</span>
                        <span class="font-medium">{{ modelo_activo.updated_at|date:"d/m/Y" }}</span>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Usuarios activos -->
            {% if usuarios_activos %}
            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300">
                <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                    <span class="bg-indigo-100 p-2 rounded-md mr-3"><i class="fas fa-users text-indigo-600"></i></span>
                    <span>Top Usuarios</span>
                </h3>
                <div class="space-y-3">
                    {% for usuario in usuarios_activos %}
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            {% if usuario.image %}
                                <img class="h-8 w-8 rounded-full" src="{{ usuario.image.url }}" alt="{{ usuario.username }}">
                            {% else %}
                                <div class="h-8 w-8 rounded-full bg-gray-300 flex items-center justify-center">
                                    <i class="fas fa-user text-gray-600 text-xs"></i>
                                </div>
                            {% endif %}
                            <div>
                                <p class="text-sm font-medium">{{ usuario.get_full_name|default:usuario.username }}</p>
                            </div>
                        </div>
                        <span class="text-sm text-primary-600 font-medium">{{ usuario.num_mascotas }}</span>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        {% endif %}

        <!-- Info del usuario actual -->
        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300">
            <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                <span class="bg-gray-100 p-2 rounded-md mr-3"><i class="fas fa-user text-gray-600"></i></span>
                <span>Mi Información</span>
            </h3>
            <div class="stat-grid text-sm">
                <div class="flex justify-between">
                    <span class="text-gray-600">Usuario:</span>
                    <span class="font-medium">{{ user.username }}</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Email:</span>
                    <span class="font-medium">{{ user.email }}</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Rol:</span>
                    <span class="font-medium">
                        {% if role == 'OWNER' %}Propietario
                        {% elif role == 'VET' %}Veterinario
                        {% elif role == 'ADMIN' %}Administrador
                        {% endif %}
                    </span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Miembro desde:</span>
                    <span class="font-medium">{{ user.date_joined|date:"d/m/Y" }}</span>
                </div>
                <div class="pt-2">
                    <a href="{% url 'auth:profile' %}" class="text-primary-600 hover:text-primary-700 text-sm font-medium">
                        <i class="fas fa-edit mr-1"></i>Editar perfil
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Accesos Rápidos - Módulos del Sidebar -->
    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 mt-8">
        <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
            <span class="bg-yellow-100 p-2 rounded-md mr-3"><i class="fas fa-bolt text-yellow-500"></i></span>
            <span>Accesos Rápidos</span>
        </h3>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 md:gap-4">
            
            <!-- Dashboard (siempre visible) -->
            <a href="{% url 'auth:Dashboard' %}" class="quick-access flex flex-col items-center p-4 bg-gray-50 hover:bg-primary-50 rounded-lg transition-all duration-300 group border border-transparent hover:border-primary-100">
                <div class="bg-primary-100 p-3 rounded-lg mb-2 group-hover:bg-primary-200 transition-all duration-300 shadow-sm">
                    <i class="fas fa-tachometer-alt text-primary-600 text-lg"></i>
                </div>
                <span class="text-sm font-medium text-gray-700 group-hover:text-primary-700 transition-colors duration-300">Dashboard</span>
            </a>

            {% if role == 'OWNER' or role == 'ADMIN' %}
            <!-- Mi Mascota (Propietarios y Admin) -->
            <a href="{% url 'mascota:main_register' %}" class="quick-access flex flex-col items-center p-4 bg-gray-50 hover:bg-blue-50 rounded-lg transition-all duration-300 group border border-transparent hover:border-blue-100">
                <div class="bg-blue-100 p-3 rounded-lg mb-2 group-hover:bg-blue-200 transition-all duration-300 shadow-sm">
                    <i class="fas fa-dog text-blue-600 text-lg"></i>
                </div>
                <span class="text-sm font-medium text-gray-700 group-hover:text-blue-700 transition-colors duration-300">Mi Mascota</span>
            </a>
            {% endif %}

            {% if role == 'VET' or role == 'ADMIN' %}
            <!-- Gestión de Usuarios (Veterinarios y Admin) -->
            <a href="{% url 'auth:users_list' %}" class="quick-access flex flex-col items-center p-4 bg-gray-50 hover:bg-green-50 rounded-lg transition-all duration-300 group border border-transparent hover:border-green-100">
                <div class="bg-green-100 p-3 rounded-lg mb-2 group-hover:bg-green-200 transition-all duration-300 shadow-sm">
                    <i class="fas fa-users text-green-600 text-lg"></i>
                </div>
                <span class="text-sm font-medium text-gray-700 group-hover:text-green-700 transition-colors duration-300">Usuarios</span>
            </a>
            {% endif %}

            <!-- Escáner (Todos los roles) -->
            <a href="{% url 'mascota:scanner' %}" class="quick-access flex flex-col items-center p-4 bg-gray-50 hover:bg-purple-50 rounded-lg transition-all duration-300 group border border-transparent hover:border-purple-100">
                <div class="bg-purple-100 p-3 rounded-lg mb-2 group-hover:bg-purple-200 transition-all duration-300 shadow-sm">
                    <i class="fas fa-qrcode text-purple-600 text-lg"></i>
                </div>
                <span class="text-sm font-medium text-gray-700 group-hover:text-purple-700 transition-colors duration-300">Escáner</span>
            </a>

            <!-- Mi Perfil (Todos los roles) -->
            <a href="{% url 'auth:profile' %}" class="quick-access flex flex-col items-center p-4 bg-gray-50 hover:bg-indigo-50 rounded-lg transition-all duration-300 group border border-transparent hover:border-indigo-100">
                <div class="bg-indigo-100 p-3 rounded-lg mb-2 group-hover:bg-indigo-200 transition-all duration-300 shadow-sm">
                    <i class="fas fa-user text-indigo-600 text-lg"></i>
                </div>
                <span class="text-sm font-medium text-gray-700 group-hover:text-indigo-700 transition-colors duration-300">Mi Perfil</span>
            </a>

            {% if role == 'OWNER' %}
            <!-- Acciones adicionales para propietarios -->
            <a href="#" onclick="window.print()" class="quick-access flex flex-col items-center p-4 bg-gray-50 hover:bg-orange-50 rounded-lg transition-all duration-300 group border border-transparent hover:border-orange-100">
                <div class="bg-orange-100 p-3 rounded-lg mb-2 group-hover:bg-orange-200 transition-all duration-300 shadow-sm">
                    <i class="fas fa-print text-orange-600 text-lg"></i>
                </div>
                <span class="text-sm font-medium text-gray-700 group-hover:text-orange-700 transition-colors duration-300">Imprimir</span>
            </a>

            <a href="{% url 'auth:logout' %}" class="quick-access flex flex-col items-center p-4 bg-gray-50 hover:bg-red-50 rounded-lg transition-all duration-300 group border border-transparent hover:border-red-100">
                <div class="bg-red-100 p-3 rounded-lg mb-2 group-hover:bg-red-200 transition-all duration-300 shadow-sm">
                    <i class="fas fa-sign-out-alt text-red-600 text-lg"></i>
                </div>
                <span class="text-sm font-medium text-gray-700 group-hover:text-red-700 transition-colors duration-300">Salir</span>
            </a>

            {% elif role == 'VET' or role == 'ADMIN' %}
            <!-- Acciones adicionales para veterinarios/admin -->
            <a href="#" class="quick-access flex flex-col items-center p-4 bg-gray-50 hover:bg-yellow-50 rounded-lg transition-all duration-300 group border border-transparent hover:border-yellow-100">
                <div class="bg-yellow-100 p-3 rounded-lg mb-2 group-hover:bg-yellow-200 transition-all duration-300 shadow-sm">
                    <i class="fas fa-chart-bar text-yellow-600 text-lg"></i>
                </div>
                <span class="text-sm font-medium text-gray-700 group-hover:text-yellow-700 transition-colors duration-300">Reportes</span>
            </a>

            <a href="{% url 'auth:logout' %}" class="quick-access flex flex-col items-center p-4 bg-gray-50 hover:bg-red-50 rounded-lg transition-all duration-300 group border border-transparent hover:border-red-100">
                <div class="bg-red-100 p-3 rounded-lg mb-2 group-hover:bg-red-200 transition-all duration-300 shadow-sm">
                    <i class="fas fa-sign-out-alt text-red-600 text-lg"></i>
                </div>
                <span class="text-sm font-medium text-gray-700 group-hover:text-red-700 transition-colors duration-300">Salir</span>
            </a>
            {% endif %}
        </div>
    </div>

</div>

{% block extra_scripts %}
<script>
// Dashboard profesional simple
document.addEventListener('DOMContentLoaded', function() {
    // Tooltips simples con mejor UX
    const tooltips = document.querySelectorAll('[title]');
    if (tooltips.length > 0) {
        tooltips.forEach(element => {
            const title = element.getAttribute('title');
            element.setAttribute('data-title', title);
            element.removeAttribute('title');
            
            element.addEventListener('mouseenter', function() {
                const tooltip = document.createElement('div');
                tooltip.className = 'absolute bg-gray-800 text-white text-xs px-2 py-1 rounded z-50 shadow-lg opacity-0 transition-opacity duration-300';
                tooltip.textContent = this.getAttribute('data-title');
                document.body.appendChild(tooltip);
                
                // Posicionar tooltip
                const rect = this.getBoundingClientRect();
                tooltip.style.top = (rect.top - tooltip.offsetHeight - 8) + 'px';
                tooltip.style.left = (rect.left + (rect.width / 2) - (tooltip.offsetWidth / 2)) + 'px';
                
                // Guardar referencia
                this.tooltip = tooltip;
                
                // Mostrar con pequeño retraso
                setTimeout(() => {
                    tooltip.style.opacity = '1';
                }, 50);
            });
            
            element.addEventListener('mouseleave', function() {
                if (this.tooltip) {
                    const tooltip = this.tooltip;
                    tooltip.style.opacity = '0';
                    setTimeout(() => {
                        document.body.removeChild(tooltip);
                    }, 300);
                }
            });
        });
    }

    // Función para refrescar datos (cada 5 minutos)
    function setupDashboardRefresh() {
        // Verificar si la página está visible
        if (document.hidden) return;
        
        // Refrescar mediante AJAX para mantener la sesión activa
        fetch(window.location.href, {
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        }).catch(error => console.log('Refresh error:', error));
    }

    // Configurar refresco cada 5 minutos
    setInterval(setupDashboardRefresh, 300000);
});
</script>
{% endblock %}

{% endblock %}
